import torch
from torch.utils.data import Dataset

class Banknotes(Dataset):

    def __init__(self, dtype=torch.float64, device='cpu'):
        self.dtype = dtype
        self.device = device
        self.load_data()

    def __repr__(self):
        return f'XOR dataset'

    def __len__(self):
        return len(self.data)

    def load_data(self):
        self.data = torch.tensor([
            [214.8, 131, 131.1, 9],
            [214.6, 129.7, 129.7, 8.1],
            [214.8, 129.7, 129.7, 8.7],
            [214.8, 129.7, 129.6, 7.5],
            [215, 129.6, 129.7, 10.4],
            [215.7, 130.8, 130.5, 9],
            [215.5, 129.5, 129.7, 7.9],
            [214.5, 129.6, 129.2, 7.2],
            [214.9, 129.4, 129.7, 8.2],
            [215.2, 130.4, 130.3, 9.2],
            [215.3, 130.4, 130.3, 7.9],
            [215.1, 129.5, 129.6, 7.7],
            [215.2, 130.8, 129.6, 7.9],
            [214.7, 129.7, 129.7, 7.7],
            [215.1, 129.9, 129.7, 7.7],
            [214.5, 129.8, 129.8, 9.3],
            [214.6, 129.9, 130.1, 8.2],
            [215, 129.9, 129.7, 9],
            [215.2, 129.6, 129.6, 7.4],
            [214.7, 130.2, 129.9, 8.6],
            [215, 129.9, 129.3, 8.4],
            [215.6, 130.5, 130, 8.1],
            [215.3, 130.6, 130, 8.4],
            [215.7, 130.2, 130, 8.7],
            [215.1, 129.7, 129.9, 7.4],
            [215.3, 130.4, 130.4, 8],
            [215.5, 130.2, 130.1, 8.9],
            [215.1, 130.3, 130.3, 9.8],
            [215.1, 130, 130, 7.4],
            [214.8, 129.7, 129.3, 8.3],
            [215.2, 130.1, 129.8, 7.9],
            [214.8, 129.7, 129.7, 8.6],
            [215, 130, 129.6, 7.7],
            [215.6, 130.4, 130.1, 8.4],
            [215.9, 130.4, 130, 8.9],
            [214.6, 130.2, 130.2, 9.4],
            [215.5, 130.3, 130, 8.4],
            [215.3, 129.9, 129.4, 7.9],
            [215.3, 130.3, 130.1, 8.5],
            [213.9, 130.3, 129, 8.1],
            [214.4, 129.8, 129.2, 8.9],
            [214.8, 130.1, 129.6, 8.8],
            [214.9, 129.6, 129.4, 9.3],
            [214.9, 130.4, 129.7, 9],
            [214.8, 129.4, 129.1, 8.2],
            [214.3, 129.5, 129.4, 8.3],
            [214.8, 129.9, 129.7, 8.3],
            [214.8, 129.9, 129.7, 7.3],
            [214.6, 129.7, 129.8, 7.9],
            [214.5, 129, 129.6, 7.8],
            [214.6, 129.8, 129.4, 7.2],
            [215.3, 130.6, 130, 9.5],
            [214.5, 130.1, 130, 7.8],
            [215.4, 130.2, 130.2, 7.6],
            [214.5, 129.4, 129.5, 7.9],
            [215.2, 129.7, 129.4, 9.2],
            [215.7, 130, 129.4, 9.2],
            [215, 129.6, 129.4, 8.8],
            [215.1, 130.1, 129.9, 7.9],
            [215.1, 130, 129.8, 8.2],
            [215.1, 129.6, 129.3, 8.3],
            [215.3, 129.7, 129.4, 7.5],
            [215.4, 129.8, 129.4, 8],
            [214.5, 130, 129.5, 8],
            [215, 130, 129.8, 8.6],
            [215.2, 130.6, 130, 8.8],
            [214.6, 129.5, 129.2, 7.7],
            [214.8, 129.7, 129.3, 9.1],
            [215.1, 129.6, 129.8, 8.6],
            [214.9, 130.2, 130.2, 8],
            [213.8, 129.8, 129.5, 8.4],
            [215.2, 129.9, 129.5, 8.2],
            [215, 129.6, 130.2, 8.7],
            [214.4, 129.9, 129.6, 7.5],
            [215.2, 129.9, 129.7, 7.2],
            [214.1, 129.6, 129.3, 7.6],
            [214.9, 129.9, 130.1, 8.8],
            [214.6, 129.8, 129.4, 7.4],
            [215.2, 130.5, 129.8, 7.9],
            [214.6, 129.9, 129.4, 7.9],
            [215.1, 129.7, 129.7, 8.6],
            [214.9, 129.8, 129.6, 7.5],
            [215.2, 129.7, 129.1, 9],
            [215.2, 130.1, 129.9, 7.9],
            [215.4, 130.7, 130.2, 9],
            [215.1, 129.9, 129.6, 8.9],
            [215.2, 129.9, 129.7, 8.7],
            [215, 129.6, 129.2, 8.4],
            [214.9, 130.3, 129.9, 7.4],
            [215, 129.9, 129.7, 8],
            [214.7, 129.7, 129.3, 8.6],
            [215.4, 130, 129.9, 8.5],
            [214.9, 129.4, 129.5, 8.2],
            [214.5, 129.5, 129.3, 7.4],
            [214.7, 129.6, 129.5, 8.3],
            [215.6, 129.9, 129.9, 9],
            [215, 130.4, 130.3, 9.1],
            [214.4, 129.7, 129.5, 8],
            [215.1, 130, 129.8, 9.1],
            [214.7, 130, 129.4, 7.8],
            [214.4, 130.1, 130.3, 9.7],
            [214.9, 130.5, 130.2, 11],
            [214.9, 130.3, 130.1, 8.7],
            [215, 130.4, 130.6, 9.9],
            [214.7, 130.2, 130.3, 11.8],
            [215, 130.2, 130.2, 10.6],
            [215.3, 130.3, 130.1, 9.3],
            [214.8, 130.1, 130.4, 9.8],
            [215, 130.2, 129.9, 10],
            [215.2, 130.6, 130.8, 10.4],
            [215.2, 130.4, 130.3, 8],
            [215.1, 130.5, 130.3, 10.6],
            [215.4, 130.7, 131.1, 9.7],
            [214.9, 130.4, 129.9, 11.4],
            [215.1, 130.3, 130, 10.6],
            [215.5, 130.4, 130, 8.2],
            [214.7, 130.6, 130.1, 11.8],
            [214.7, 130.4, 130.1, 12.1],
            [214.8, 130.5, 130.2, 11],
            [214.4, 130.2, 129.9, 10.1],
            [214.8, 130.3, 130.4, 10.1],
            [215.1, 130.6, 130.3, 12.3],
            [215.3, 130.8, 131.1, 11.6],
            [215.1, 130.7, 130.4, 10.5],
            [214.7, 130.5, 130.5, 9.9],
            [214.9, 130, 130.3, 10.2],
            [215, 130.4, 130.4, 9.4],
            [215.5, 130.7, 130.3, 10.2],
            [215.1, 130.2, 130.2, 10.1],
            [214.5, 130.2, 130.6, 9.8],
            [214.3, 130.2, 130, 10.7],
            [214.5, 130.2, 129.8, 12.3],
            [214.9, 130.5, 130.2, 10.6],
            [214.6, 130.2, 130.4, 10.5],
            [214.2, 130, 130.2, 11],
            [214.8, 130.1, 130.1, 11.9],
            [214.6, 129.8, 130.2, 10.7],
            [214.9, 130.7, 130.3, 9.3],
            [214.6, 130.4, 130.4, 11.3],
            [214.5, 130.5, 130.2, 11.8],
            [214.8, 130.2, 130.3, 10],
            [214.7, 130, 129.4, 10.2],
            [214.6, 130.2, 130.4, 11.2],
            [215, 130.5, 130.4, 10.6],
            [214.5, 129.8, 129.8, 11.4],
            [214.9, 130.6, 130.4, 11.9],
            [215, 130.5, 130.4, 11.4],
            [215.3, 130.6, 130.3, 9.3],
            [214.7, 130.2, 130.1, 10.7],
            [214.9, 129.9, 130, 9.9],
            [214.9, 130.3, 129.9, 11.9],
            [214.6, 129.9, 129.7, 11.9],
            [214.6, 129.7, 129.3, 10.4],
            [214.5, 130.1, 130.1, 12.1],
            [214.5, 130.3, 130, 11],
            [215.1, 130, 130.3, 11.6],
            [214.2, 129.7, 129.6, 10.3],
            [214.4, 130.1, 130, 11.3],
            [214.8, 130.4, 130.6, 12.5],
            [214.6, 130.6, 130.1, 8.1],
            [215.6, 130.1, 129.7, 7.4],
            [214.9, 130.5, 130.1, 9.9],
            [214.6, 130.1, 130, 11.5],
            [214.7, 130.1, 130.2, 11.6],
            [214.3, 130.3, 130, 11.4],
            [215.1, 130.3, 130.6, 10.3],
            [216.3, 130.7, 130.4, 10],
            [215.6, 130.4, 130.1, 9.6],
            [214.8, 129.9, 129.8, 9.6],
            [214.9, 130, 129.9, 11.4],
            [213.9, 130.7, 130.5, 8.7],
            [214.2, 130.6, 130.4, 12],
            [214.8, 130.5, 130.3, 11.8],
            [214.8, 129.6, 130, 10.4],
            [214.8, 130.1, 130, 11.4],
            [214.9, 130.4, 130.2, 11.9],
            [214.3, 130.1, 130.1, 11.6],
            [214.5, 130.4, 130, 9.9],
            [214.8, 130.5, 130.3, 10.2],
            [214.5, 130.2, 130.4, 8.2],
            [215, 130.4, 130.1, 11.4],
            [214.8, 130.6, 130.6, 8],
            [215, 130.5, 130.1, 11],
            [214.6, 130.5, 130.4, 10.1],
            [214.7, 130.2, 130.1, 10.7],
            [214.7, 130.4, 130, 11.5],
            [214.5, 130.4, 130, 8],
            [214.8, 130, 129.7, 11.4],
            [214.8, 129.9, 130.2, 9.6],
            [214.6, 130.3, 130.2, 12.7],
            [215.1, 130.2, 129.8, 10.2],
            [215.4, 130.5, 130.6, 8.8],
            [214.7, 130.3, 130.2, 10.8],
            [215, 130.5, 130.3, 9.6],
            [214.9, 130.3, 130.5, 11.6],
            [215, 130.4, 130.3, 9.9],
            [215.1, 130.3, 129.9, 10.3],
            [214.8, 130.3, 130.4, 10.6],
            [214.7, 130.7, 130.8, 11.2],
            [214.3, 129.9, 129.9, 10.2]
        ], dtype=self.dtype, device=self.device)

        self.labels = torch.tensor(100*[[0]] + 100*[[1]], dtype=self.dtype, device=self.device)

    def __getitem__(self,  idx):
        return self.data[idx], self.labels[idx]
